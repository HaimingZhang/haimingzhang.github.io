---
layout: post
title: DB主从延时
date: 2018-05-20 15:32:24.000000000 +09:00
---

### 1.背景  
由于业务扩展，访问量急速增长，导致mysql的CPU使用率达到80%，IO达到90%  

### 2.解决方案  
master - slave  
减轻了主库（写）压力：主要业务读操作，做读写分离后，读压力转移到了从库，主库的压力减小了数十倍。
从库（读）可水平扩展（加从库机器）：因系统压力主要是读请求，而从库又可水平扩展，当从库压力太时，可直接添加从库机器，缓解读请求压力  

### 3.新挑战  
业务高峰期Mysql的主从延时达到10s  

### 4.如何避免或解决主从延时  
```  
优化Mysql参数，比如增大innodb_buffer_pool_size，让更多操作在Mysql内存中完成，减少磁盘操作。
使用高性能CPU主机
数据库使用物理主机，避免使用虚拟云主机，提升IO性能
使用SSD磁盘，提升IO性能。SSD的随机IO性能约是SATA硬盘的10倍。
业务代码优化，将实时性要求高的某些操作，使用主库做读操作
```

